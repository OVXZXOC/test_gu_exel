<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Premie GU</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>
<body>

<div class="container">
  <h1>Kalkulator Premii - Gang Unit</h1>

  <form id="formularz">
    <label for="name">Imię:</label>
    <input type="text" id="name" name="name" required><br><br>

    <label for="surname">Nazwisko:</label>
    <input type="text" id="surname" name="surname" required><br><br>

    <label for="uid">UID:</label>
    <input type="text" id="uid" name="uid" placeholder="Wpisz UID" required><br><br>

    <!-- Cennik -->
    <div id="akcje"></div>

    <button type="button" onclick="policzPremie()">Oblicz premię</button>
    <button type="submit">Zapisz do Google Sheets</button>
  </form>
</div>

<script>
const cennik = {
  "Patrol (Screen z dispatcha)": 2000,
  "Reakcja na marka": 5000,
  "Cayo/FZ": 10000,
  "Wezwania": 2000,
  "Przesłuchanie": 15000,
  "Napad na biznes": 6000,
  "Stworzenie teczki": 50000,
  "Napad na bank": 7000,
  "Drop, MCL": 25000,
  "Dealerzy, magazyny": 15000,
  "Udzial w tasku": 5000,
  "Aresztowania": 3000,
  "Pomoc w akademiach itd": 5000,
  "Porwania, Arenki itp": 7000,
  "Złapanie opaski": 7000
};

// Generowanie formularza z akcjami
const formularz = document.getElementById("akcje");
for (let akcja in cennik) {
  formularz.innerHTML += `
    <div class="akcja">
      <label>${akcja}</label>
      <input type="number" id="${akcja}" min="0">
    </div>
  `;
}

function policzPremie() {
  let suma = 0;
  for (let akcja in cennik) {
    const ilosc = parseInt(document.getElementById(akcja).value) || 0;
    suma += ilosc * cennik[akcja];
  }
  alert(`Łączna premia: ${suma.toLocaleString()} $`);
  return suma; // Zwracamy premię, żeby można było ją zapisać w formularzu
}

document.getElementById('formularz').addEventListener('submit', function(event) {
  event.preventDefault(); // Zapobiega domyślnemu wysłaniu formularza

  // Zbieramy dane z formularza
  const name = document.getElementById('name').value;
  const surname = document.getElementById('surname').value;
  const uid = document.getElementById('uid').value;

  // Walidacja UID – sprawdzamy, czy to liczby (mogą być dowolnej długości)
  const uidPattern = /^\d+$/;
  if (!uidPattern.test(uid)) {
    alert("UID musi składać się tylko z cyfr!");
    return;
  }

  const premia = policzPremie(); // Liczymy premię

  // Tworzymy dane do wysłania
  const formData = new FormData();
  formData.append('name', name);
  formData.append('surname', surname);
  formData.append('uid', uid);
  formData.append('bonus', premia);

  // Wysyłamy dane do Google Sheets
  fetch('https://script.google.com/macros/s/AKfycbxQq7uFxcLF__zwGMHRYtqxoZ2rXBn4RTY-VRC0zXsAkTdlAZFVaasNKUGeYC0m9woiLA/exec', {
    method: 'POST',
    body: formData
  })
  .then(response => response.text())
  .then(result => {
    console.log('Data saved:', result);
    alert('Dane zostały zapisane do Google Sheets');
  })
  .catch(error => {
    console.error('Error:', error);
    alert('Wystąpił błąd przy zapisywaniu danych.');
  });
});
</script>

</body>
</html>
